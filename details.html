<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./css/details.css">
</head>
<body>
    <div id="bc">
        <div id="top">
            <div class="t-left">
                <span>欢迎光临鞋都网!</span>
                <a id="login">登陆</a>
                <a id='register'>免费注册</a>
            </div>
            <div class="t-right">
                <a href="">我的信息</a>
                <a href="" class="shop">我关注的店铺</a>
                <a href="./car.html" class="shop">购物车</a>
                <a href="">收藏夹</a>
                <a href="">手机版</a>
            </div>
        </div>
        <div class="header">
        <div class="clear1">
            <div class="w1210">
               
                <div class="mall-logo">
                    <a href="#">
                        <img src="./imgs/logo.png">
                    </a>
                </div>
                <div class="mall-logo-right"></div>
    
                <div class="mall-search"><!--开头的搜索-->
                    <form class="mall-form">
                        <input type="text" class="kuang" value="请输入关键词">
                        <a href="">搜 索</a>
                    </form>
                    <div class="mall-bai"><!--搜索框下面的小白鞋-->
                        <a href="">小白鞋</a><span>|</span>
                        <a href="">高更鞋</a><span>|</span>
                        <a href="">老爹鞋</a><span>|</span>
                        <a href="">小熊鞋</a><span>|</span>
                        <a href="">豆豆鞋</a><span>|</span>
                        <a href="">休闲鞋</a>
                    </div>
                </div>
                <div class="header-right">
                    <a href=""><img src="./imgs/1dai.jpg" alt=""></a>
                    <a href=""><img src="./imgs/7bao.jpg" alt=""></a>
                    <a href=""><img src="./imgs/7tui.jpg" alt=""></a>
                </div>
            </div>
        </div>  
        </div>
    </div>
    <div class="nav">
        <div class="w1210">
            <div class="classification">
                <a href="">全部商品分类</a>
            </div>
            <div class="navall">
                <a href="./next.html">首页</a>
                <a href="./next.html">新品</a>
                <a href="./next.html">休闲鞋</a>
                <a href="./next.html">运动鞋</a>
                <a href="./next.html">高跟鞋</a>
                <a href="./next.html">特价区</a>
                <a href="./next.html">招商加盟</a>
                <a href="./next.html">【鞋界头条】</a>
            </div>
        </div>
    </div>
    <div class="details-show">
        <div class="details-goods">
            <div class="details-left">
                <img src="./imgs/details-1.jpg">
            </div>
            <!-- <div class="details-right">
                <h3>83517欧美2018新款粗跟绒面女士高跟鞋凉鞋单鞋广州女鞋红色婚鞋</h3>
                <div class="details-right-div">
                    <span>￥79</span>
                    <span>降价通知</span>
                </div>
                <input type="button" value="+" class="jia">
                <input type="text" value="1" class="number">
                <input type="button" value="-" class="jian"> -->
                 <!-- <a href=""><img src="./imgs/商品介绍.jpg"></a>
                <a href=""><img src="./imgs/商品介绍2.jpg"></a>
                <a href=""><img src="./imgs/商品介绍3.jpg"></a>
                <a href=""><img src="./imgs/商品介绍4.jpg"></a>
                <a href=""><img src="./imgs/商品介绍5.jpg"></a><br> -->
                <!-- <span>尺码</span>
                <span>27</span>
                <span>28</span>
                <span>29</span><br>
                <p>立即进货</p>
                <p>加入购物车</p>
            </div> -->
        </div>
       <div class="details-jpg">
            <ul>
                <li>
                    <span>商品名称：83517欧美2018</span>
                    <span>品牌：T&Q</span>
                </li>
            </ul>
        </div>
    </div>
    <!--底部1-->
<div class="footer">
    <div class="footer-clear">
        <div class="footer-top">
            <dl class="article">
                <dt>新手上路</dt>
                <dd>进货流程</dd>
                <dd>常见问题</dd>
                <dd>新手专区</dd>
            </dl>
            <dl class="article">
                <dt>买家安全保障</dt>
                <dd>支付安全保障</dd>
                <dd>货物与货款</dd>
                <dd>平台与入驻商</dd>
            </dl>
            <dl class="article">
                <dt>配送方式</dt>
                <dd>订单状态</dd>
                <dd>国内可配送物流</dd>
                <dd>Global Shipping</dd>
            </dl>
            <dl class="article">
                <dt>售后服务</dt>
                <dd>售后流程</dd>
                <dd>零风险进货</dd>
                <dd>退换货政策</dd>
            </dl>
            <dl class="article">
                <dt>关于我们</dt>
                <dd>网站故障报告</dd>
                <dd>选机咨询</dd>
                <dd>投诉与建议</dd>
            </dl>
            <dl class="article">
                <dt>服务支持</dt>
                <dd>售前咨询: 181-5050-7238</dd>
                <dd>售后咨询: 181-5050-3638</dd>
                <dd>客服 QQ: 460823391</dd>
                <dd>工作时间 9：00-23：00</dd>
            </dl>
        </div>
        <div class="footer-bottom"></div>
    </div>
</div>
<!--底部2-->    
<div class="footer-last">
        <div class="last-center">
            <p>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
            </p>
            <p>
                <a href="#">© 2005-2019 鞋都网 版权所有，并保留所有权利</a>
                <a href="#">晋江陈埭鞋都电商园 Tel: 18150507238 E-mail: vipkefu@800vi.com</a>
            </p>
            <img src="./imgs/rz1.png" alt="">
            <img src="./imgs/rz2.png" alt="">
            <img src="./imgs/rz3.png" alt="">
            <p>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
            </p>
            <p>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
            </p>
            <p>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
                <a href="#">关于我们</a><span>|</span>
            </p>
        </div>
    </div>

    <!-- 登陆弹出框 -->
<div class="popOutBg"></div>
<div class="popOut">
    <span title="关闭"> x </span>
    <table>
        <caption>欢迎登录本网站</caption>
        <tr>
            <td class="one">用户名：</td>
            <td><input type="text" class="inp user" placeholder="请输入用户名" /></td>
        </tr>
        <tr>
            <td class="one">密码：</td>
            <td><input type="password" class="inp pass pass3" placeholder="请输入密码" /></td>
        </tr>
        <tr>
            <td class="one">确认密码</td>
            <td><input type="password" class="inp pass2 pass4" placeholder="确认密码" /></td>
        </tr>
        <tr>
            <td colspan="2"><input type="button" class="login" value="登录" /></td>
            
        </tr>
    </table>
</div>
</body>
<script src="./js/jq.js"></script>
<script src="./js/coolie.js"></script>
<script>
    let id = location.search.split('=')[1];
    console.log(id)
     $.ajax({
            url:"data/data3.json",
            success:function(res){
                var str = ""
                for(var i=0;i<res.length;i++){
                    if(res[i].goodsId == id){
                        str += `
                        <div class="details-left">
                            <img src="${res[i].img}">
                        </div>
                        <div class="details-right">
                            <h3>${res[i].name}</h3>
                                <div class="details-right-div">
                                    <span>${res[i].price}</span>
                                    <span>降价通知</span>
                                </div>
                        <input type="button" value="+" class="jia">
                        <input type="text" value="1" class="number">
                        <input type="button" value="-" class="jian">
                            <span>尺码</span>
                        <span>27</span>
                        <span>28</span>
                        <span>29</span><br>
                        <p>立即进货</p>
                        <p><a  class="ADD" href ="car.html?goodsId=${res[i].goodsId}">加入购物车</a></p>
                            </div>
                        </div>
                                `;
                    }
                }
                $(".details-goods").children(".details-left").html(str);
              add($(".ADD"));
            }
        })
        function add(label){
            var abc = getQueryVariable("goodsId");
            var obj = {
                num:abc
            }
            var arr = [];
            arr.push(obj);
            label.on("click",function(){
                setCookie("num",JSON.stringify(arr),{
                    expires:3
                });
            })
        }

//登陆注册
class Login{
    constructor(){
        this.user = document.querySelector(".inp");
        this.pass = document.querySelector(".pass");
        this.loginEnter = document.querySelector("#login");
        this.registerEnter = document.querySelector("#register");
        this.t = 1;
        this.check = document.querySelector(".pass2");
        this.login = document.querySelector(".login");
        this.addEvent();
        // this.display();
    }
    addEvent(){
        var that = this;
        this.loginEnter.onclick=function(){
            that.t = 1;
            that.check.parentNode.parentNode.style.display = "none";

        }
        this.registerEnter.onclick=function(){
            that.t = 2;
            that.check.parentNode.parentNode.style.display = "table-row";
            
        }
        this.login.onclick = function(){
            that.u = that.user.value;
            that.p = that.pass.value;
            that.usermsg = getCookie("userMsg") ? JSON.parse(getCookie("userMsg")) : [];
            console.log(that.usermsg)
            if(that.t == 1){
                that.loginEve();
            }else{
                that.registerEve();
            }
        }
    }
    loginEve(){
        this.success = false;
        console.log(this.u);
        console.log(this.p)
        for(let i = 0; i < this.usermsg.length; i++){
            if(this.usermsg[i].user == this.u && this.usermsg[i].pass == this.p){
                alert("登陆成功");
                location.href = "";
                this.success = true;
                setCookie("nowUser", this.usermsg[i].user);
            }
        }
        if(!this.success){
            alert("登陆失败");
        }
    }
    registerEve(){
        this.isBeing = false;
        if(this.check.value == this.p){
            for(let i = 0; i < this.usermsg.length; i++){
                if(this.u == this.usermsg[i].user){
                    alert("用户名已存在");
                    this.isBeing = true;
                }
            }
            if(!this.isBeing){
                let obj = {
                    user:this.u,
                    pass:this.p
                }
                this.usermsg.push(obj);
                setCookie("userMsg", JSON.stringify(this.usermsg),{
                    expires:100
                });
                alert("注册成功");
            }
        }else{
            alert("两次输入不一样");
        }
    }
    
}
new Login;
class Welcome{
    constructor(){
        this.titleBox = document.querySelector(".t-left");
        this.init();
    }
    init(){
        this.nowUser = getCookie("nowUser");
        if(this.nowUser){
            this.titleBox.innerHTML = `欢迎你，${this.nowUser}<a class = 'logout'>退出登录</a>`;
            this.logoutEve();
        }
    }
    logoutEve(){
        this.logout = document.querySelector(".logout");
        this.logout.onclick = function(){
            setCookie("nowUser", "");
            location.href = "";
        }
    }
}
new Welcome;

//登陆
function _sel(param){
    if(arguments[1] == true){
        return document.querySelectorAll(param);
    }else{
        return document.querySelector(param);
    }
    }

    function ani(){
    _sel(".popOut").className = "popOut ani";
    }

    $("#login").on("click",function(){
    _sel(".popOut").style.display = "block";
    ani();
    _sel(".popOutBg").style.display = "block";
    $('.regShow').css({display:'none'});
    $('.login').val('登陆')
    });
    _sel(".popOut > span").onclick = function(){
    _sel(".popOut").style.display = "none";
    _sel(".popOutBg").style.display = "none";
    };
    _sel(".popOutBg").onclick = function(){
    _sel(".popOut").style.display = "none";
    _sel(".popOutBg").style.display = "none";
    };

    //注册
    $('#register').on('click',function(){
    _sel(".popOut").style.display = "block";
    ani();
    _sel(".popOutBg").style.display = "block";
    $('.regShow').css({display:'block'});
    $('.login').val('注册')
    })
    _sel(".popOut > span").onclick = function(){
    _sel(".popOut").style.display = "none";
    _sel(".popOutBg").style.display = "none";
    };
    _sel(".popOutBg").onclick = function(){
    _sel(".popOut").style.display = "none";
    _sel(".popOutBg").style.display = "none";
    };



    function getQueryVariable(key) {
        // 获取参数
        var url = window.location.search;
        // 正则筛选地址栏
        var reg = new RegExp("(^|&)" + key + "=([^&]*)(&|$)");
        // 匹配目标参数
        var result = url.substr(1).match(reg);
        //返回参数值
        return result ? decodeURIComponent(result[2]) : null;
    }

</script>
</html>